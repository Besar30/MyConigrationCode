  public static WebApplicationBuilder AddAuthenticationServices(this WebApplicationBuilder builder) { 

      builder.Services.AddIdentity<IdentityUser,IdentityRole>()
          .AddEntityFrameworkStores<ApplicationIdentityDbContext>();


      builder.Services.Configure<JwtAuthOptions>(builder.Configuration.GetSection("Jwt"));

      JwtAuthOptions jwtAuthOptions=builder.Configuration.GetSection("Jwt").Get<JwtAuthOptions>()!;

      builder.Services
             .AddAuthentication(options=> { 
              options.DefaultAuthenticateScheme=JwtBearerDefaults.AuthenticationScheme;
              options.DefaultChallengeScheme=JwtBearerDefaults.AuthenticationScheme;
             }// JwtBearerDefaults.AuthenticationScheme
             )
             .AddJwtBearer(options =>
             {
                 options.TokenValidationParameters = new TokenValidationParameters
                 {
                     ValidIssuer=jwtAuthOptions.Issuer,
                     ValidAudience=jwtAuthOptions.Audience,
                     IssuerSigningKey=new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtAuthOptions.Key)),

                 };
             });
      builder.Services.AddAuthorization();
      return builder;
  }
